# TheGradCafe Data Analysis App

This project is a Flask-based web application for scraping, cleaning, analyzing, and displaying graduate admissions data from TheGradCafe. It integrates a PostgreSQL database backend, supports idempotent data updates, and provides a user-friendly interface for monitoring application trends.

Documentation is available at: [Read the Docs](https://jhu-software-concepts-andrew-ho.readthedocs.io/en/latest/index.html#)

---

## Features

- **Scraping:** Collects raw admissions data from TheGradCafe.
- **Data Cleaning:** Standardizes and processes scraped data.
- **Database Loading:** Inserts cleaned data into PostgreSQL.
- **Analysis:** Computes statistics such as average GPA, GRE scores, and acceptance rates.
- **Web Interface:** Users can pull new data, re-run analyses, and view dashboards.

---

## Setup & Installation

### 1. Clone the Repository
```bash
git clone git@github.com/andrew-ho7705/jhu_software_concepts.git
cd jhu_software_concepts
```
### 2. Create and Activate a Virtual Environment
Create a virtual environment to isolate dependencies:

```bash
cd module_4
python -m venv venv
```
Activate the environment:

On Linux / macOS:

```bash
source venv/bin/activate
```
On Windows:

```bash
venv\Scripts\activate
```
### 3. Install Dependencies
```bash
pip install -r requirements.txt
```

### 4. Set Up PostgreSQL Database
Launch PostgreSQL (ensure it is installed and running). Connect to the database using psql:

```bash
psql -U postgres
```
Create a new database and table for the project:

```sql
CREATE TABLE applicants (
    p_id int GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    program text,
    comments text,
    date_added date,
    url text unique,
    status text,
    term text,
    us_or_international text,
    gpa float,
    gre float,
    gre_v float,
    gre_aw float,
    degree text,
    llm_generated_program text,
    llm_generated_university text
);
```

### 5. Run the Flask Application
Start the Flask development server from the root directory:

```bash
python -m module_4.src.app.app
```
The application will be accessible at http://localhost:8080.

### Operational Notes

Busy-State Policy: Only one operation (data pull or analysis) runs at a time.

Idempotency: Re-running POST /pull_data or POST /update_analysis will not create duplicates. Existing records are updated as needed.

Uniqueness Keys: The database enforces uniqueness for fields p_id and url.

**Testing**

Run All Tests

```bash
pytest -m "web or buttons or analysis or db or integration"
```
Note: Example applicant data is used for testing database queries and HTML rendering. Ensure fields like GPA, GRE, program, and university are populated to pass assertions.

### Troubleshooting

**Local Development:**

Verify PostgreSQL is running and reachable.

Check environment variables for database credentials.

If TypeError: must be real number, not NoneType appears, confirm numeric fields (e.g., GPA, GRE) are present in example data.

**Continuous Integration (CI):**

Ensure the CI environment mirrors local setup (Python version, environment variables, database access).

Check test logs for missing dependencies or misconfigurations.

**Common Issues:**

Division by zero during analysis usually indicates missing data for a query. Add example data to cover all scenarios.

HTML assertions failing may indicate LLM or cleaning steps did not populate necessary fields.